[
  {
    "path": "posts/",
    "title": "Jornada Basin Lizards NLS",
    "description": {},
    "author": [
      {
        "name": "Sarah Lam",
        "url": {}
      }
    ],
    "date": "2022-02-22",
    "categories": [],
    "contents": "\n\n\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\n\nlibrary(tidyverse)\nlibrary(here)\nlibrary(equatiomatic)\nlibrary(Metrics)\nlibrary(cowplot)\nlibrary(modelr)\nlibrary(kableExtra)\nlibrary(broom)\n\n\n\nOverview\nThis code uses non linear least squares to estimate parameters of a length to weight model for lizard populations in New Mexico. The data used is originally from the Jornada Basin LTER site, all but the variables that we are interested in have been removed.\nSource: Lightfoot, D. and W.G. Whitford. 2020. Lizard pitfall trap data from 11 NPP study locations at the Jornada Basin LTER site, 1989-2006 ver 37. Environmental Data Initiative. https://doi.org/10.6073/pasta/4a6e258fb49c31e222ecbbcfd128967f\n\n\n#read in data\nlizard <- read_csv(here(\"_posts\", \"lizard.csv\")) %>% \n  select(spp, sex, SV_length, weight) %>% \n  janitor::clean_names() %>% \n  mutate(across(where(is.character), tolower)) %>% \n  select(spp, sex, sv_length, weight)\n\n\n\nNon Linear Least Squares Snout Length and Weight Model\nHere we aim to fit a snout-to-vent length to weight model of the following form to all lizards in our dataframe.\n\\[\\begin{equation}\nW=a(SVL)^b\n\\end{equation}\\]\nIn this equation weight is given by W, snout to vent length by SVL, and a and b are the parameters that need to be fitted. Approximations of the parameters are derived from the regression coefficients of a standard OLS done on the log transformed data.\n\n\n#log transform the data \nlog_data <- lizard %>% \n  mutate(log_length = log(sv_length), \n         log_weight = log(weight))\n\n# OLS regression to find parameters\nmodel_guess <- lm(log_weight ~ log_length, data = log_data)\n\nguess_coefs <- coef(model_guess) #pull coefficients for use in nls \n\n\n\n\n\n#create function for nls\nweight_model <- function(a, sv_length, b){\n  weight = a*sv_length^b\n    return(weight)\n}\n\n\n\nAll Lizards\n\n\n#nls with guesses \nlizard_nls = nls(weight ~ weight_model(a,sv_length,b), \n                 data = lizard,\n                 start = list(\n                    a = exp(guess_coefs[1]), #transform coefficient out of log form\n                    b = guess_coefs[2]))\n\ntidy_lizard <- tidy(lizard_nls) %>% \n  mutate(p.value = ifelse(p.value <.002, paste(\"<.002\"))) %>% \n  kable(col.names = c(\"Term\",\n                      \"Estimate\", \n                      \"Standard Error\", \n                      \"Statistic\", \n                      \"P-Value\"), \n        caption = \"**Table 1.** Non linear least squares model for all lizards sampled at Jornada Basin LTER.\") %>% \n   kable_classic(full_width = FALSE)\n\ntidy_lizard\n\n\n\nTable 1: Table 1. Non linear least squares model for all lizards sampled at Jornada Basin LTER.\n\n\nTerm\n\n\nEstimate\n\n\nStandard Error\n\n\nStatistic\n\n\nP-Value\n\n\na\n\n\n0.0003411\n\n\n0.0000400\n\n\n8.538421\n\n\n<.002\n\n\nb\n\n\n2.4532065\n\n\n0.0269791\n\n\n90.930011\n\n\n<.002\n\n\n\n\nnls_predict <- augment(lizard_nls) #make nls data into ggplot usable format\n\nggplot() +\n  geom_point(data = lizard, aes(x = sv_length, y = weight, color = sex)) +\n  scale_color_manual(values = c(\"gold1\", \"deepskyblue\"), \n                     labels = c(\"Female\", \"Male\"),\n                     name = \"Lizard Sex\") +\n  geom_line(data = nls_predict, aes(x = sv_length, y = .fitted)) +\n  theme_minimal()+\n  labs(x = \"Weight (g)\", \n       y = \"Length (mm)\", \n       title = \"NLS Model of Weight for Jornada Basin Lizards (Lam)\")\n\n\n\n\nFigure 1: Figure 1. Non-linear least square model for weight(g) as a function of snout to vent length (mm) for lizards sampled in Jornada Basin LTER site. Lizard data points are broken down by sex, male (blue) and female (yellow).\n\n\n\nWestern Whiptail Lizards\nNow we fit the nls model to male western whiptail lizards.\n\n\n#doing nls all over again\nmale_whip <- lizard %>% \n  filter(spp == \"cnti\", \n         sex == \"m\")\n\nwhip_log <- male_whip %>% \n  mutate(log_length = log(sv_length), \n         log_weight = log(weight))\n\nwhip_guess <- lm(log_weight ~ log_length, data = whip_log)\n\nwhip_coefs <- coef(whip_guess)\n\nmale_whip_nls = nls(weight ~ weight_model(a,sv_length,b), #weight model remains the same\n                 data = male_whip,\n                 start = list(\n                    a = exp(whip_coefs[1]),\n                    b = whip_coefs[2]))\n\ntidy_whip <- tidy(male_whip_nls) %>% \n  mutate(p.value = case_when(p.value <.002 ~ \"<.002\", \n                             p.value >.002 ~ as.character(round(p.value, 3)))) %>% \n  kable(col.names = c(\"Term\",\n                      \"Estimate\", \n                      \"Standard Error\", \n                      \"Statistic\", \n                      \"P-Value\"), \n        caption = \"Non linear least squares model for male western whiptail lizards in Jornada Basin LTER.\") %>% \n   kable_classic(full_width = FALSE)\n\ntidy_whip\n\n\n\nTable 2: Non linear least squares model for male western whiptail lizards in Jornada Basin LTER.\n\n\nTerm\n\n\nEstimate\n\n\nStandard Error\n\n\nStatistic\n\n\nP-Value\n\n\na\n\n\n0.0005316\n\n\n0.0004288\n\n\n1.239686\n\n\n0.219\n\n\nb\n\n\n2.3683013\n\n\n0.1800348\n\n\n13.154689\n\n\n<.002\n\n\nwhip_rmse <- rmse(male_whip_nls, data = male_whip) \nwhip_general_rmse <- rmse(lizard_nls, data = male_whip)\n\n\n\n\n\n#general nls and male whip nls on male whip data\nwhip_predict <- augment(male_whip_nls)\n\nggplot() +\n  geom_point(data = male_whip, \n             aes(x = sv_length, y = weight), \n             color = \"deepskyblue\") +\n  geom_line(data = nls_predict, \n            aes(x = sv_length, y = .fitted, color = \"All Lizard Model\")) +\n  geom_line(data = whip_predict, \n            aes(x = sv_length, y = .fitted, color = \"Western Whiptail Model\")) +\n  scale_color_manual(values = c(\"darkcyan\", \"darkgoldenrod\"), \n                     name = \"NLS Model\") +\n  scale_x_continuous(breaks = seq(from=0, to=125, by=25), limits = c(0, 125)) +\n  scale_y_continuous(breaks = seq(from=0, to=40, by=10), limits = (c(0, 40))) +\n  theme_minimal() +\n  labs(x = \"Weight (g)\", \n       y = \"Length (mm)\", \n       title = \"Comparative NLS Models for Male Western Whiptail Lizards (Lam)\")\n\n\n\n\nFigure 2. Two non-linear least squares models for weight as a function of snout to vent length for male western whiptail lizards. The teal line shows the model developed from a larger dataset of male and female lizards of varying species applied to the presented western whiptail data. The gold line shows an nls model derived from the male western whiptail data and applied to that same data. The gold line model appears to be a slightly better fit for the data based on the model’s RMSE of 3.35 compared to the more general model’s RMSE of 3.56.\n\n\n\n",
    "preview": "posts/work_ex_lizards_files/figure-html5/unnamed-chunk-5-1.png",
    "last_modified": "2022-02-22T13:19:46-08:00",
    "input_file": "work_ex_lizards.knit.md"
  },
  {
    "path": "posts/2022-02-07-welcome/",
    "title": "welcome",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Sarah Lam",
        "url": {}
      }
    ],
    "date": "2022-02-07",
    "categories": [],
    "contents": "\nDistill is a publication format for scientific and technical writing, native to the web.\nLearn more about using Distill at https://rstudio.github.io/distill.\n\n\n\n",
    "preview": {},
    "last_modified": "2022-02-07T11:48:22-08:00",
    "input_file": {}
  }
]
